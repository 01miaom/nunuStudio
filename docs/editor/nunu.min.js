var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.getGlobal=function(a){return'undefined'!=typeof window&&window===a?a:'undefined'!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.checkEs6ConformanceViaProxy=function(){try{var a={},c=Object.create(new $jscomp.global.Proxy(a,{get:function(h,b,e){return h==a&&'q'==b&&e==c}}));return!0===c.q}catch(h){return!1}};$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS=!1;
$jscomp.ES6_CONFORMANCE=$jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS&&$jscomp.checkEs6ConformanceViaProxy();$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||'function'==typeof Object.defineProperties?Object.defineProperty:function(a,c,h){a!=Array.prototype&&a!=Object.prototype&&(a[c]=h.value)};$jscomp.SYMBOL_PREFIX='jscomp_symbol_';
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(c){return $jscomp.SYMBOL_PREFIX+(c||'')+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol('iterator'));'function'!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var c=0;return $jscomp.iteratorPrototype(function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var c=a[Symbol.iterator];return c?c.call(a):$jscomp.arrayIterator(a)};$jscomp.owns=function(a,c){return Object.prototype.hasOwnProperty.call(a,c)};
$jscomp.polyfill=function(a,c,h,b){if(c){h=$jscomp.global;a=a.split('.');for(b=0;b<a.length-1;b++){var e=a[b];e in h||(h[e]={});h=h[e]}a=a[a.length-1];b=h[a];c=c(b);c!=b&&null!=c&&$jscomp.defineProperty(h,a,{configurable:!0,writable:!0,value:c})}};
$jscomp.polyfill('WeakMap',function(a){function c(){if(!a||!Object.seal)return!1;try{var b=Object.seal({}),c=Object.seal({}),f=new a([[b,2],[c,3]]);if(2!=f.get(b)||3!=f.get(c))return!1;f.delete(b);f.set(c,4);return!f.has(b)&&4==f.get(c)}catch(t){return!1}}function h(a){$jscomp.owns(a,e)||$jscomp.defineProperty(a,e,{value:{}})}function b(a){var b=Object[a];b&&(Object[a]=function(a){h(a);return b(a)})}if($jscomp.USE_PROXY_FOR_ES6_CONFORMANCE_CHECKS){if(a&&$jscomp.ES6_CONFORMANCE)return a}else if(c())return a;
var e='$jscomp_hidden_'+Math.random();b('freeze');b('preventExtensions');b('seal');var f=0,l=function(a){this.id_=(f+=Math.random()+1).toString();if(a){$jscomp.initSymbol();$jscomp.initSymbolIterator();a=$jscomp.makeIterator(a);for(var b;!(b=a.next()).done;)b=b.value,this.set(b[0],b[1])}};l.prototype.set=function(a,b){h(a);if(!$jscomp.owns(a,e))throw Error('WeakMap key fail: '+a);a[e][this.id_]=b;return this};l.prototype.get=function(a){return $jscomp.owns(a,e)?a[e][this.id_]:void 0};l.prototype.has=
function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)};l.prototype.delete=function(a){return $jscomp.owns(a,e)&&$jscomp.owns(a[e],this.id_)?delete a[e][this.id_]:!1};return l},'es6','es3');$jscomp.checkStringArgs=function(a,c,h){if(null==a)throw new TypeError("The 'this' value for String.prototype."+h+' must not be null or undefined');if(c instanceof RegExp)throw new TypeError('First argument to String.prototype.'+h+' must not be a regular expression');return a+''};
$jscomp.polyfill('String.prototype.startsWith',function(a){return a?a:function(a,h){var b=$jscomp.checkStringArgs(this,a,'startsWith');a+='';var c=b.length,f=a.length;h=Math.max(0,Math.min(h|0,b.length));for(var l=0;l<f&&h<c;)if(b[h++]!=a[l++])return!1;return l>=f}},'es6','es3');$jscomp.polyfill('Number.EPSILON',function(a){return Math.pow(2,-52)},'es6','es3');$jscomp.polyfill('Math.sign',function(a){return a?a:function(a){a=Number(a);return 0===a||isNaN(a)?a:0<a?1:-1}},'es6','es3');
$jscomp.iteratorFromArray=function(a,c){$jscomp.initSymbolIterator();a instanceof String&&(a+='');var h=0,b={next:function(){if(h<a.length){var e=h++;return{value:c(e,a[e]),done:!1}}b.next=function(){return{done:!0,value:void 0}};return b.next()}};b[Symbol.iterator]=function(){return b};return b};$jscomp.polyfill('Array.prototype.keys',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a){return a})}},'es6','es3');
$jscomp.polyfill('Array.prototype.values',function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,h){return h})}},'es8','es3');$jscomp.assign='function'==typeof Object.assign?Object.assign:function(a,c){for(var h=1;h<arguments.length;h++){var b=arguments[h];if(b)for(var e in b)$jscomp.owns(b,e)&&(a[e]=b[e])}return a};$jscomp.polyfill('Object.assign',function(a){return a||$jscomp.assign},'es6','es3');
$jscomp.polyfill('String.prototype.repeat',function(a){return a?a:function(a){var c=$jscomp.checkStringArgs(this,null,'repeat');if(0>a||1342177279<a)throw new RangeError('Invalid count value');a|=0;for(var b='';a;)if(a&1&&(b+=c),a>>>=1)c+=c;return b}},'es6','es3');$jscomp.polyfill('Number.isFinite',function(a){return a?a:function(a){return'number'!==typeof a?!1:!isNaN(a)&&Infinity!==a&&-Infinity!==a}},'es6','es3');
$jscomp.polyfill('Number.isInteger',function(a){return a?a:function(a){return Number.isFinite(a)?a===Math.floor(a):!1}},'es6','es3');$jscomp.polyfill('Array.prototype.fill',function(a){return a?a:function(a,h,b){var c=this.length||0;0>h&&(h=Math.max(0,c+h));if(null==b||b>c)b=c;b=Number(b);0>b&&(b=Math.max(0,c+b));for(h=Number(h||0);h<b;h++)this[h]=a;return this}},'es6','es3');
$jscomp.polyfill('String.prototype.endsWith',function(a){return a?a:function(a,h){var b=$jscomp.checkStringArgs(this,a,'endsWith');a+='';void 0===h&&(h=b.length);h=Math.max(0,Math.min(h|0,b.length));for(var c=a.length;0<c&&0<h;)if(b[--h]!=a[--c])return!1;return 0>=c}},'es6','es3');$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill('Promise',function(a){function c(){this.batch_=null}function h(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;c.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};c.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var b=$jscomp.global.setTimeout;c.prototype.asyncExecuteFunction=function(a){b(a,
0)};c.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(r){this.asyncThrow_(r)}}}this.batch_=null};c.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(n){b.reject(n)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(f){c||(c=!0,a.call(b,f))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError('A Promise cannot resolve to itself'));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case 'object':var b=null!=a;break a;case 'function':b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(n){this.reject_(n);return}'function'==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error('Cannot settle('+a+', '+b|'): Promise already settled in state'+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new c;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(r){c.reject(r)}};e.prototype.then=function(a,b){function c(a,b){return'function'==typeof a?function(b){try{f(a(b))}catch(z){l(z)}}:b}var f,l,d=new e(function(a,
b){f=a;l=b});this.callWhenSettled_(c(a,f),c(b,l));return d};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(e.state_){case 1:a(e.result_);break;case 2:b(e.result_);break;default:throw Error('Unexpected state: '+e.state_);}}var e=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=h;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
c){for(var f=$jscomp.makeIterator(a),e=f.next();!e.done;e=f.next())h(e.value).callWhenSettled_(b,c)})};e.all=function(a){var b=$jscomp.makeIterator(a),c=b.next();return c.done?h([]):new e(function(a,f){function d(b){return function(d){k[b]=d;e--;0==e&&a(k)}}var k=[],e=0;do k.push(void 0),e++,h(c.value).callWhenSettled_(d(k.length-1),f),c=b.next();while(!c.done)})};return e},'es6','es3');
$jscomp.polyfill('Object.is',function(a){return a?a:function(a,h){return a===h?0!==a||1/a===1/h:a!==a&&h!==h}},'es6','es3');$jscomp.polyfill('Array.prototype.includes',function(a){return a?a:function(a,h){var b=this;b instanceof String&&(b=String(b));var c=b.length;for(h=h||0;h<c;h++)if(b[h]==a||Object.is(b[h],a))return!0;return!1}},'es7','es3');
$jscomp.polyfill('String.prototype.includes',function(a){return a?a:function(a,h){return-1!==$jscomp.checkStringArgs(this,a,'includes').indexOf(a,h||0)}},'es6','es3');
(function(a,c){'object'===typeof exports&&'undefined'!==typeof module?c(exports):'function'===typeof define&&define.amd?define(['exports'],c):c(a.THREE={})})(this,function(a){function c(){}function h(g,a){this.x=g||0;this.y=a||0}function b(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];0<arguments.length&&console.error('THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.')}function e(g,a,b,d){this._x=g||0;this._y=a||0;this._z=b||0;this._w=void 0!==d?d:1}function f(g,a,
b){this.x=g||0;this.y=a||0;this.z=b||0}function l(){this.elements=[1,0,0,0,1,0,0,0,1];0<arguments.length&&console.error('THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.')}function m(g,a,b,d,c,f,k,e,p,n){Object.defineProperty(this,'id',{value:Nf++});this.uuid=ja.generateUUID();this.name='';this.image=void 0!==g?g:m.DEFAULT_IMAGE;this.mipmaps=[];this.mapping=void 0!==a?a:m.DEFAULT_MAPPING;this.wrapS=void 0!==b?b:1001;this.wrapT=void 0!==d?d:1001;this.magFilter=void 0!==
c?c:1006;this.minFilter=void 0!==f?f:1008;this.anisotropy=void 0!==p?p:1;this.format=void 0!==k?k:1023;this.type=void 0!==e?e:1009;this.offset=new h(0,0);this.repeat=new h(1,1);this.center=new h(0,0);this.rotation=0;this.matrixAutoUpdate=!0;this.matrix=new l;this.generateMipmaps=!0;this.premultiplyAlpha=!1;this.flipY=!0;this.unpackAlignment=4;this.encoding=void 0!==n?n:3E3;this.version=0;this.onUpdate=null}function n(g,a,b,d){this.x=g||0;this.y=a||0;this.z=b||0;this.w=void 0!==d?d:1}function r(g,
a,b){this.width=g;this.height=a;this.scissor=new n(0,0,g,a);this.scissorTest=!1;this.viewport=new n(0,0,g,a);b=b||{};void 0===b.minFilter&&(b.minFilter=1006);this.texture=new m(void 0,void 0,b.wrapS,b.wrapT,b.magFilter,b.minFilter,b.format,b.type,b.anisotropy,b.encoding);this.texture.generateMipmaps=void 0!==b.generateMipmaps?b.generateMipmaps:!0;this.depthBuffer=void 0!==b.depthBuffer?b.depthBuffer:!0;this.stencilBuffer=void 0!==b.stencilBuffer?b.stencilBuffer:!0;this.depthTexture=void 0!==b.depthTexture?
b.depthTexture:null}function t(g,a,b){r.call(this,g,a,b);this.activeMipMapLevel=this.activeCubeFace=0}function d(g,a,b,d,c,f,k,e,l,p,h,n){m.call(this,null,f,k,e,l,p,d,c,h,n);this.image={data:g,width:a,height:b};this.magFilter=void 0!==l?l:1003;this.minFilter=void 0!==p?p:1003;this.flipY=this.generateMipmaps=!1;this.unpackAlignment=1}function k(g,a){this.min=void 0!==g?g:new f(Infinity,Infinity,Infinity);this.max=void 0!==a?a:new f(-Infinity,-Infinity,-Infinity)}function u(g,a){this.center=void 0!==
g?g:new f;this.radius=void 0!==a?a:0}function w(g,a){this.normal=void 0!==g?g:new f(1,0,0);this.constant=void 0!==a?a:0}function z(g,a,b,d,c,f){this.planes=[void 0!==g?g:new w,void 0!==a?a:new w,void 0!==b?b:new w,void 0!==d?d:new w,void 0!==c?c:new w,void 0!==f?f:new w]}function y(g,a,b){return void 0===a&&void 0===b?this.set(g):this.setRGB(g,a,b)}function p(){function g(q,D){!1!==b&&(d(q,D),a.requestAnimationFrame(g))}var a=null,b=!1,d=null;return{start:function(){!0!==b&&null!==d&&(a.requestAnimationFrame(g),
b=!0)},stop:function(){b=!1},setAnimationLoop:function(g){d=g},setContext:function(g){a=g}}}function v(g){function a(a,q){var b=a.array,D=a.dynamic?g.DYNAMIC_DRAW:g.STATIC_DRAW,d=g.createBuffer();g.bindBuffer(q,d);g.bufferData(q,b,D);a.onUploadCallback();q=g.FLOAT;b instanceof Float32Array?q=g.FLOAT:b instanceof Float64Array?console.warn('THREE.WebGLAttributes: Unsupported data buffer format: Float64Array.'):b instanceof Uint16Array?q=g.UNSIGNED_SHORT:b instanceof Int16Array?q=g.SHORT:b instanceof
Uint32Array?q=g.UNSIGNED_INT:b instanceof Int32Array?q=g.INT:b instanceof Int8Array?q=g.BYTE:b instanceof Uint8Array&&(q=g.UNSIGNED_BYTE);return{buffer:d,type:q,bytesPerElement:b.BYTES_PER_ELEMENT,version:a.version}}var b=new WeakMap;return{get:function(g){g.isInterleavedBufferAttribute&&(g=g.data);return b.get(g)},remove:function(a){a.isInterleavedBufferAttribute&&(a=a.data);var q=b.get(a);q&&(g.deleteBuffer(q.buffer),b.delete(a))},update:function(q,D){q.isInterleavedBufferAttribute&&(q=q.data);
var d=b.get(q);if(void 0===d)b.set(q,a(q,D));else if(d.version<q.version){var c=q,f=c.array,k=c.updateRange;g.bindBuffer(D,d.buffer);!1===c.dynamic?g.bufferData(D,f,g.STATIC_DRAW):-1===k.count?g.bufferSubData(D,0,f):0===k.count?console.error('THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually.'):(g.bufferSubData(D,k.offset*f.BYTES_PER_ELEMENT,f.subarray(k.offset,k.offset+k.count)),k.count=
-1);d.version=q.version}}}}function x(g,a,b,d){this._x=g||0;this._y=a||0;this._z=b||0;this._order=d||x.DefaultOrder}function B(){this.mask=1}function A(){Object.defineProperty(this,'id',{value:Of++});this.uuid=ja.generateUUID();this.name='';this.type='Object3D';this.parent=null;this.children=[];this.up=A.DefaultUp.clone();var g=new f,a=new x,D=new e,d=new f(1,1,1);a.onChange(function(){D.setFromEuler(a,!1)});D.onChange(function(){a.setFromQuaternion(D,void 0,!1)});Object.defineProperties(this,{position:{enumerable:!0,
value:g},rotation:{enumerable:!0,value:a},quaternion:{enumerable:!0,value:D},scale:{enumerable:!0,value:d},modelViewMatrix:{value:new b},normalMatrix:{value:new l}});this.matrix=new b;this.matrixWorld=new b;this.matrixAutoUpdate=A.DefaultMatrixAutoUpdate;this.matrixWorldNeedsUpdate=!1;this.layers=new B;this.visible=!0;this.receiveShadow=this.castShadow=!1;this.frustumCulled=!0;this.renderOrder=0;this.userData={}}function E(){A.call(this);this.type='Camera';this.matrixWorldInverse=new b;this.projectionMatrix=
new b}function F(g,a,b,d,c,f){E.call(this);this.type='OrthographicCamera';this.zoom=1;this.view=null;this.left=g;this.right=a;this.top=b;this.bottom=d;this.near=void 0!==c?c:.1;this.far=void 0!==f?f:2E3;this.updateProjectionMatrix()}function C(g,a,b,d,c,k){this.a=g;this.b=a;this.c=b;this.normal=d&&d.isVector3?d:new f;this.vertexNormals=Array.isArray(d)?d:[];this.color=c&&c.isColor?c:new y;this.vertexColors=Array.isArray(c)?c:[];this.materialIndex=void 0!==k?k:0}function I(){Object.defineProperty(this,
'id',{value:Pf+=2});this.uuid=ja.generateUUID();this.name='';this.type='Geometry';this.vertices=[];this.colors=[];this.faces=[];this.faceVertexUvs=[[]];this.morphTargets=[];this.morphNormals=[];this.skinWeights=[];this.skinIndices=[];this.lineDistances=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.lineDistancesNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.uvsNeedUpdate=this.verticesNeedUpdate=this.elementsNeedUpdate=!1}function J(g,a,b){if(Array.isArray(g))throw new TypeError('THREE.BufferAttribute: array should be a Typed Array.');
this.name='';this.array=g;this.itemSize=a;this.count=void 0!==g?g.length/a:0;this.normalized=!0===b;this.dynamic=!1;this.updateRange={offset:0,count:-1};this.version=0}function N(g,a,b){J.call(this,new Int8Array(g),a,b)}function K(g,a,b){J.call(this,new Uint8Array(g),a,b)}function L(g,a,b){J.call(this,new Uint8ClampedArray(g),a,b)}function R(g,a,b){J.call(this,new Int16Array(g),a,b)}function G(g,a,b){J.call(this,new Uint16Array(g),a,b)}function O(g,a,b){J.call(this,new Int32Array(g),a,b)}function Y(g,
a,b){J.call(this,new Uint32Array(g),a,b)}function M(g,a,b){J.call(this,new Float32Array(g),a,b)}function ea(g,a,b){J.call(this,new Float64Array(g),a,b)}function X(){this.vertices=[];this.normals=[];this.colors=[];this.uvs=[];this.uvs2=[];this.groups=[];this.morphTargets={};this.skinWeights=[];this.skinIndices=[];this.boundingSphere=this.boundingBox=null;this.groupsNeedUpdate=this.uvsNeedUpdate=this.colorsNeedUpdate=this.normalsNeedUpdate=this.verticesNeedUpdate=!1}function U(g){if(0===g.length)return-Infinity;
for(var a=g[0],b=1,d=g.length;b<d;++b)g[b]>a&&(a=g[b]);return a}function H(){Object.defineProperty(this,'id',{value:Qf+=2});this.uuid=ja.generateUUID();this.name='';this.type='BufferGeometry';this.index=null;this.attributes={};this.morphAttributes={};this.groups=[];this.boundingSphere=this.boundingBox=null;this.drawRange={start:0,count:Infinity};this.userData={}}function V(g,a,b,d,c,f){I.call(this);this.type='BoxGeometry';this.parameters={width:g,height:a,depth:b,widthSegments:d,heightSegments:c,
depthSegments:f};this.fromBufferGeometry(new Q(g,a,b,d,c,f));this.mergeVertices()}function Q(g,a,b,d,c,k){function q(g,a,q,b,d,c,k,t,m,r,u){var v=c/m,T=k/r,w=c/2,ka=k/2,x=t/2;k=m+1;var z=r+1,ya=c=0,ta,y,E=new f;for(y=0;y<z;y++){var B=y*T-ka;for(ta=0;ta<k;ta++)E[g]=(ta*v-w)*b,E[a]=B*d,E[q]=x,l.push(E.x,E.y,E.z),E[g]=0,E[a]=0,E[q]=0<t?1:-1,p.push(E.x,E.y,E.z),S.push(ta/m),S.push(1-y/r),c+=1}for(y=0;y<r;y++)for(ta=0;ta<m;ta++)g=h+ta+k*(y+1),a=h+(ta+1)+k*(y+1),q=h+(ta+1)+k*y,e.push(h+ta+k*y,g,q),e.push(g,
a,q),ya+=6;D.addGroup(n,ya,u);n+=ya;h+=c}H.call(this);this.type='BoxBufferGeometry';this.parameters={width:g,height:a,depth:b,widthSegments:d,heightSegments:c,depthSegments:k};var D=this;g=g||1;a=a||1;b=b||1;d=Math.floor(d)||1;c=Math.floor(c)||1;k=Math.floor(k)||1;var e=[],l=[],p=[],S=[],h=0,n=0;q('z','y','x',-1,-1,b,a,g,k,c,0);q('z','y','x',1,-1,b,a,-g,k,c,1);q('x','z','y',1,1,g,b,a,d,k,2);q('x','z','y',1,-1,g,b,-a,d,k,3);q('x','y','z',1,-1,g,a,b,d,c,4);q('x','y','z',-1,-1,g,a,-b,d,c,5);this.setIndex(e);
this.addAttribute('position',new M(l,3));this.addAttribute('normal',new M(p,3));this.addAttribute('uv',new M(S,2))}function ia(g,a,b,d){I.call(this);this.type='PlaneGeometry';this.parameters={width:g,height:a,widthSegments:b,heightSegments:d};this.fromBufferGeometry(new ca(g,a,b,d));this.mergeVertices()}function ca(g,a,b,d){H.call(this);this.type='PlaneBufferGeometry';this.parameters={width:g,height:a,widthSegments:b,heightSegments:d};g=g||1;a=a||1;var q=g/2,D=a/2;b=Math.floor(b)||1;d=Math.floor(d)||
1;var c=b+1,k=d+1,f=g/b,e=a/d,l=[],p=[],S=[],h=[];for(g=0;g<k;g++){var n=g*e-D;for(a=0;a<c;a++)p.push(a*f-q,-n,0),S.push(0,0,1),h.push(a/b),h.push(1-g/d)}for(g=0;g<d;g++)for(a=0;a<b;a++)q=a+c*(g+1),D=a+1+c*(g+1),k=a+1+c*g,l.push(a+c*g,q,k),l.push(q,D,k);this.setIndex(l);this.addAttribute('position',new M(p,3));this.addAttribute('normal',new M(S,3));this.addAttribute('uv',new M(h,2))}function W(){Object.defineProperty(this,'id',{value:Sf++});this.uuid=ja.generateUUID();this.name='';this.type='Material';
this.lights=this.fog=!0;this.blending=1;this.side=0;this.flatShading=!1;this.vertexColors=0;this.opacity=1;this.transparent=!1;this.blendSrc=204;this.blendDst=205;this.blendEquation=100;this.blendEquationAlpha=this.blendDstAlpha=this.blendSrcAlpha=null;this.depthFunc=3;this.depthWrite=this.depthTest=!0;this.clippingPlanes=null;this.clipShadows=this.clipIntersection=!1;this.shadowSide=null;this.colorWrite=!0;this.precision=null;this.polygonOffset=!1;this.polygonOffsetUnits=this.polygonOffsetFactor=
0;this.dithering=!1;this.alphaTest=0;this.premultipliedAlpha=!1;this.overdraw=0;this.visible=!0;this.userData={};this.needsUpdate=!0}function ha(g){W.call(this);this.type='MeshBasicMaterial';this.color=new y(16777215);this.lightMap=this.map=null;this.lightMapIntensity=1;this.aoMap=null;this.aoMapIntensity=1;this.envMap=this.alphaMap=this.specularMap=null;this.combine=0;this.reflectivity=1;this.refractionRatio=.98;this.wireframe=!1;this.wireframeLinewidth=1;this.wireframeLinejoin=this.wireframeLinecap=
'round';this.lights=this.morphTargets=this.skinning=!1;this.setValues(g)}function fa(g){W.call(this);this.type='ShaderMaterial';this.defines={};this.uniforms={};this.vertexShader='void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}';this.fragmentShader='void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}';this.linewidth=1;this.wireframe=!1;this.wireframeLinewidth=1;this.morphNormals=this.morphTargets=this.skinning=this.clipping=this.lights=this.fog=
!1;this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1};this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]};this.index0AttributeName=void 0;this.uniformsNeedUpdate=!1;void 0!==g&&(void 0!==g.attributes&&console.error('THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead.'),this.setValues(g))}function Z(g,a){this.origin=void 0!==g?g:new f;this.direction=void 0!==a?a:new f}function ba(g,a,b){this.a=void 0!==g?g:new f;this.b=void 0!==
a?a:new f;this.c=void 0!==b?b:new f}function na(g,a){A.call(this);this.type='Mesh';this.geometry=void 0!==g?g:new H;this.material=void 0!==a?a:new ha({color:16777215*Math.random()});this.drawMode=0;this.updateMorphTargets()}function Ga(g,a,b,d){function q(g,q){a.buffers.color.setClear(g.r,g.g,g.b,q,d)}var D=new y(0),c=0,k,f,e;return{getClearColor:function(){return D},setClearColor:function(g,a){D.set(g);c=void 0!==a?a:1;q(D,c)},getClearAlpha:function(){return c},setClearAlpha:function(g){c=g;q(D,
c)},render:function(a,d,l,p){d=d.background;null===d?q(D,c):d&&d.isColor&&(q(d,1),p=!0);(g.autoClear||p)&&g.clear(g.autoClearColor,g.autoClearDepth,g.autoClearStencil);d&&d.isCubeTexture?(void 0===e&&(e=new na(new Q(1,1,1),new fa({uniforms:Hb.cube.uniforms,vertexShader:Hb.cube.vertexShader,fragmentShader:Hb.cube.fragmentShader,side:1,depthTest:!0,depthWrite:!1,fog:!1})),e.geometry.removeAttribute('normal'),e.geometry.removeAttribute('uv'),e.onBeforeRender=function(g,a,q){this.matrixWorld.copyPosition(q.matrixWorld)},
b.update(e)),e.material.uniforms.tCube.value=d,a.push(e,e.geometry,e.material,0,null)):d&&d.isTexture&&(void 0===k&&(k=new F(-1,1,1,-1,0,1),f=new na(new ca(2,2),new ha({depthTest:!1,depthWrite:!1,fog:!1})),b.update(f)),f.material.map=d,g.renderBufferDirect(k,null,f.geometry,f.material,f,null))}}}function Sa(g,a,b,d){var q;this.setMode=function(g){q=g};this.render=function(a,d){g.drawArrays(q,a,d);b.update(d,q)};this.renderInstances=function(D,c,k){if(d.isWebGL2)var f=g;else if(f=a.get('ANGLE_instanced_arrays'),
null===f){console.error('THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');return}f[d.isWebGL2?'drawArraysInstanced':'drawArraysInstancedANGLE'](q,c,k,D.maxInstancedCount);b.update(k,q,D.maxInstancedCount)}}function jb(g,a,b){function q(a){if('highp'===a){if(0<g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.HIGH_FLOAT).precision&&0<g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.HIGH_FLOAT).precision)return'highp';a='mediump'}return'mediump'===
a&&0<g.getShaderPrecisionFormat(g.VERTEX_SHADER,g.MEDIUM_FLOAT).precision&&0<g.getShaderPrecisionFormat(g.FRAGMENT_SHADER,g.MEDIUM_FLOAT).precision?'mediump':'lowp'}var d,D='undefined'!==typeof WebGL2RenderingContext&&g instanceof WebGL2RenderingContext,c=void 0!==b.precision?b.precision:'highp',k=q(c);k!==c&&(console.warn('THREE.WebGLRenderer:',c,'not supported, using',k,'instead.'),c=k);b=!0===b.logarithmicDepthBuffer;k=g.getParameter(g.MAX_TEXTURE_IMAGE_UNITS);var f=g.getParameter(g.MAX_VERTEX_TEXTURE_IMAGE_UNITS),
e=g.getParameter(g.MAX_TEXTURE_SIZE),l=g.getParameter(g.MAX_CUBE_MAP_TEXTURE_SIZE),p=g.getParameter(g.MAX_VERTEX_ATTRIBS),h=g.getParameter(g.MAX_VERTEX_UNIFORM_VECTORS),n=g.getParameter(g.MAX_VARYING_VECTORS),m=g.getParameter(g.MAX_FRAGMENT_UNIFORM_VECTORS),t=0<f,r=D||!!a.get('OES_texture_float');return{isWebGL2:D,getMaxAnisotropy:function(){if(void 0!==d)return d;var q=a.get('EXT_texture_filter_anisotropic');return d=null!==q?g.getParameter(q.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0},getMaxPrecision:q,
precision:c,logarithmicDepthBuffer:b,maxTextures:k,maxVertexTextures:f,maxTextureSize:e,maxCubemapSize:l,maxAttributes:p,maxVertexUniforms:h,maxVaryings:n,maxFragmentUniforms:m,vertexTextures:t,floatFragmentTextures:r,floatVertexTextures:t&&r}}function kb(){function g(){h.value!==d&&(h.value=d,h.needsUpdate=0<c);b.numPlanes=c;b.numIntersection=0}function a(g,a,q,d){var D=null!==g?g.length:0,c=null;if(0!==D){c=h.value;if(!0!==d||null===c){d=q+4*D;a=a.matrixWorldInverse;p.getNormalMatrix(a);if(null===
c||c.length<d)c=new Float32Array(d);for(d=0;d!==D;++d,q+=4)e.copy(g[d]).applyMatrix4(a,p),e.normal.toArray(c,q),c[q+3]=e.constant}h.value=c;h.needsUpdate=!0}b.numPlanes=D;return c}var b=this,d=null,c=0,k=!1,f=!1,e=new w,p=new l,h={value:null,needsUpdate:!1};this.uniform=h;this.numIntersection=this.numPlanes=0;this.init=function(g,q,b){var D=0!==g.length||q||0!==c||k;k=q;d=a(g,b,0);c=g.length;return D};this.beginShadows=function(){f=!0;a(null)};this.endShadows=function(){f=!1;g()};this.setState=function(q,
b,D,e,l,p){if(!k||null===q||0===q.length||f&&!D)f?a(null):g();else{D=f?0:c;var S=4*D,n=l.clippingState||null;h.value=n;n=a(q,e,S,p);for(q=0;q!==S;++q)n[q]=d[q];l.clippingState=n;this.numIntersection=b?this.numPlanes:0;this.numPlanes+=D}}}function lb(g){var a={};return{get:function(q){if(void 0!==a[q])return a[q];switch(q){case 'WEBGL_depth_texture':var b=g.getExtension('WEBGL_depth_texture')||g.getExtension('MOZ_WEBGL_depth_texture')||g.getExtension('WEBKIT_WEBGL_depth_texture');break;case 'EXT_texture_filter_anisotropic':b=
g.getExtension('EXT_texture_filter_anisotropic')||g.getExtension('MOZ_EXT_texture_filter_anisotropic')||g.getExtension('WEBKIT_EXT_texture_filter_anisotropic');break;case 'WEBGL_compressed_texture_s3tc':b=g.getExtension('WEBGL_compressed_texture_s3tc')||g.getExtension('MOZ_WEBGL_compressed_texture_s3tc')||g.getExtension('WEBKIT_WEBGL_compressed_texture_s3tc');break;case 'WEBGL_compressed_texture_pvrtc':b=g.getExtension('WEBGL_compressed_texture_pvrtc')||g.getExtension('WEBKIT_WEBGL_compressed_texture_pvrtc');
break;default:b=g.getExtension(q)}null===b&&console.warn('THREE.WebGLRenderer: '+q+' extension not supported.');return a[q]=b}}}function mb(g,a,b){function q(g){var c=g.target;g=d[c.id];null!==g.index&&a.remove(g.index);for(var k in g.attributes)a.remove(g.attributes[k]);c.removeEventListener('dispose',q);delete d[c.id];if(k=D[g.id])a.remove(k),delete D[g.id];b.memory.geometries--}var d={},D={};return{get:function(g,a){var D=d[a.id];if(D)return D;a.addEventListener('dispose',q);a.isBufferGeometry?
D=a:a.isGeometry&&(void 0===a._bufferGeometry&&(a._bufferGeometry=(new H).setFromObject(g)),D=a._bufferGeometry);d[a.id]=D;b.memory.geometries++;return D},update:function(q){var b=q.index,d=q.attributes;null!==b&&a.update(b,g.ELEMENT_ARRAY_BUFFER);for(var D in d)a.update(d[D],g.ARRAY_BUFFER);q=q.morphAttributes;for(D in q){b=q[D];d=0;for(var c=b.length;d<c;d++)a.update(b[d],g.ARRAY_BUFFER)}},getWireframeAttribute:function(q){var b=D[q.id];if(b)return b;b=[];var d=q.index,c=q.attributes;if(null!==
d){d=d.array;c=0;for(var k=d.length;c<k;c+=3){var f=d[c+0],e=d[c+1],l=d[c+2];b.push(f,e,e,l,l,f)}}else for(d=c.position.array,c=0,k=d.length/3-1;c<k;c+=3)f=c+0,e=c+1,l=c+2,b.push(f,e,e,l,l,f);b=new (65535<U(b)?Y:G)(b,1);a.update(b,g.ELEMENT_ARRAY_BUFFER);return D[q.id]=b}}}function ke(g,a,b,d){var q,D,c;this.setMode=function(g){q=g};this.setIndex=function(g){D=g.type;c=g.bytesPerElement};this.render=function(a,d){g.drawElements(q,d,D,a*c);b.update(d,q)};this.renderInstances=function(k,f,e){if(d.isWebGL2)var l=
g;else if(l=a.get('ANGLE_instanced_arrays'),null===l){console.error('THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.');return}l[d.isWebGL2?'drawElementsInstanced':'drawElementsInstancedANGLE'](q,e,D,f*c,k.maxInstancedCount);b.update(e,q,k.maxInstancedCount)}}function le(g){var a={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:{geometries:0,textures:0},render:a,programs:null,autoReset:!0,reset:function(){a.frame++;
a.calls=0;a.triangles=0;a.points=0;a.lines=0},update:function(q,b,d){d=d||1;a.calls++;switch(b){case g.TRIANGLES:a.triangles+=q/3*d;break;case g.TRIANGLE_STRIP:case g.TRIANGLE_FAN:a.triangles+=d*(q-2);break;case g.LINES:a.lines+=q/2*d;break;case g.LINE_STRIP:a.lines+=d*(q-1);break;case g.LINE_LOOP:a.lines+=d*q;break;case g.POINTS:a.points+=d*q;break;default:console.error('THREE.WebGLInfo: Unknown draw mode:',b)}}}}function me(g,a){return Math.abs(a[1])-Math.abs(g[1])}function ne(g){var a={},b=new Float32Array(8);
return{update:function(q,d,D,c){var k=q.morphTargetInfluences,f=k.length;q=a[d.id];if(void 0===q){q=[];for(var e=0;e<f;e++)q[e]=[e,0];a[d.id]=q}var l=D.morphTargets&&d.morphAttributes.position;D=D.morphNormals&&d.morphAttributes.normal;for(e=0;e<f;e++){var p=q[e];0!==p[1]&&(l&&d.removeAttribute('morphTarget'+e),D&&d.removeAttribute('morphNormal'+e))}for(e=0;e<f;e++)p=q[e],p[0]=e,p[1]=k[e];q.sort(me);for(e=0;8>e;e++){if(p=q[e])if(k=p[0],f=p[1]){l&&d.addAttribute('morphTarget'+e,l[k]);D&&d.addAttribute('morphNormal'+
e,D[k]);b[e]=f;continue}b[e]=0}c.getUniforms().setValue(g,'morphTargetInfluences',b)}}}function oe(g,a){var q={};return{update:function(b){var d=a.render.frame,D=b.geometry,c=g.get(b,D);q[c.id]!==d&&(D.isGeometry&&c.updateFromObject(b),g.update(c),q[c.id]=d);return c},dispose:function(){q={}}}}function Ta(g,a,b,d,c,k,f,e,l,p){g=void 0!==g?g:[];m.call(this,g,void 0!==a?a:301,b,d,c,k,f,e,l,p);this.flipY=!1}function Da(g,a,b){var q=g[0];if(0>=q||0<q)return g;var d=a*b,D=Ye[d];void 0===D&&(D=new Float32Array(d),
Ye[d]=D);if(0!==a)for(q.toArray(D,0),q=1,d=0;q!==a;++q)d+=b,g[q].toArray(D,d);return D}function oa(g,a){if(g.length!==a.length)return!1;for(var q=0,b=g.length;q<b;q++)if(g[q]!==a[q])return!1;return!0}function qa(g,a){for(var q=0,b=a.length;q<b;q++)g[q]=a[q]}function Dd(g,a){var q=Ze[a];void 0===q&&(q=new Int32Array(a),Ze[a]=q);for(var b=0;b!==a;++b)q[b]=g.allocTextureUnit();return q}function Lc(g,a){var q=this.cache;q[0]!==a&&(g.uniform1f(this.addr,a),q[0]=a)}function bc(g,a){var q=this.cache;q[0]!==
a&&(g.uniform1i(this.addr,a),q[0]=a)}function nb(g,a){var q=this.cache;if(void 0!==a.x){if(q[0]!==a.x||q[1]!==a.y)g.uniform2f(this.addr,a.x,a.y),q[0]=a.x,q[1]=a.y}else oa(q,a)||(g.uniform2fv(this.addr,a),qa(q,a))}function Ed(g,a){var q=this.cache;if(void 0!==a.x){if(q[0]!==a.x||q[1]!==a.y||q[2]!==a.z)g.uniform3f(this.addr,a.x,a.y,a.z),q[0]=a.x,q[1]=a.y,q[2]=a.z}else if(void 0!==a.r){if(q[0]!==a.r||q[1]!==a.g||q[2]!==a.b)g.uniform3f(this.addr,a.r,a.g,a.b),q[0]=a.r,q[1]=a.g,q[2]=a.b}else oa(q,a)||(g.uniform3fv(this.addr,
a),qa(q,a))}function cc(g,a){var q=this.cache;if(void 0!==a.x){if(q[0]!==a.x||q[1]!==a.y||q[2]!==a.z||q[3]!==a.w)g.uniform4f(this.addr,a.x,a.y,a.z,a.w),q[0]=a.x,q[1]=a.y,q[2]=a.z,q[3]=a.w}else oa(q,a)||(g.uniform4fv(this.addr,a),qa(q,a))}function wb(g,a){var q=this.cache,b=a.elements;void 0===b?oa(q,a)||(g.uniformMatrix2fv(this.addr,!1,a),qa(q,a)):oa(q,b)||($e.set(b),g.uniformMatrix2fv(this.addr,!1,$e),qa(q,b))}function Fd(g,a){var q=this.cache,b=a.elements;void 0===b?oa(q,a)||(g.uniformMatrix3fv(this.addr,
!1,a),qa(q,a)):oa(q,b)||(af.set(b),g.uniformMatrix3fv(this.addr,!1,af),qa(q,b))}function xb(g,a){var q=this.cache,b=a.elements;void 0===b?oa(q,a)||(g.uniformMatrix4fv(this.addr,!1,a),qa(q,a)):oa(q,b)||(bf.set(b),g.uniformMatrix4fv(this.addr,!1,bf),qa(q,b))}function Mc(g,a,b){var q=this.cache,d=b.allocTextureUnit();q[0]!==d&&(g.uniform1i(this.addr,d),q[0]=d);b.setTexture2D(a||cf,d)}function Gd(g,a,b){var q=this.cache,d=b.allocTextureUnit();q[0]!==d&&(g.uniform1i(this.addr,d),q[0]=d);b.setTextureCube(a||
df,d)}function ob(g,a){var q=this.cache;oa(q,a)||(g.uniform2iv(this.addr,a),qa(q,a))}function cb(g,a){var q=this.cache;oa(q,a)||(g.uniform3iv(this.addr,a),qa(q,a))}function pb(g,a){var q=this.cache;oa(q,a)||(g.uniform4iv(this.addr,a),qa(q,a))}function Hd(g){switch(g){case 5126:return Lc;case 35664:return nb;case 35665:return Ed;case 35666:return cc;case 35674:return wb;case 35675:return Fd;case 35676:return xb;case 35678:case 36198:return Mc;case 35680:return Gd;case 5124:case 35670:return bc;case 35667:case 35671:return ob;
case 35668:case 35672:return cb;case 35669:case 35673:return pb}}function qb(g,a){var q=this.cache;oa(q,a)||(g.uniform1fv(this.addr,a),qa(q,a))}function yb(g,a){var q=this.cache;oa(q,a)||(g.uniform1iv(this.addr,a),qa(q,a))}function Nc(g,a){var q=this.cache;a=Da(a,this.size,2);oa(q,a)||(g.uniform2fv(this.addr,a),this.updateCache(a))}function Ha(g,a){var q=this.cache;a=Da(a,this.size,3);oa(q,a)||(g.uniform3fv(this.addr,a),this.updateCache(a))}function Id(g,a){var q=this.cache;a=Da(a,this.size,4);oa(q,
a)||(g.uniform4fv(this.addr,a),this.updateCache(a))}function Na(g,a){var q=this.cache;a=Da(a,this.size,4);oa(q,a)||(g.uniformMatrix2fv(this.addr,!1,a),this.updateCache(a))}function dc(g,a){var q=this.cache;a=Da(a,this.size,9);oa(q,a)||(g.uniformMatrix3fv(this.addr,!1,a),this.updateCache(a))}function ec(g,a){var q=this.cache;a=Da(a,this.size,16);oa(q,a)||(g.uniformMatrix4fv(this.addr,!1,a),this.updateCache(a))}function fc(g,a,b){var q=this.cache,d=a.length,c=Dd(b,d);!1===oa(q,c)&&(g.uniform1iv(this.addr,
c),qa(q,c));for(g=0;g!==d;++g)b.setTexture2D(a[g]||cf,c[g])}function db(g,a,b){var q=this.cache,d=a.length,c=Dd(b,d);!1===oa(q,c)&&(g.uniform1iv(this.addr,c),qa(q,c));for(g=0;g!==d;++g)b.setTextureCube(a[g]||df,c[g])}function Ib(g){switch(g){case 5126:return qb;case 35664:return Nc;case 35665:return Ha;case 35666:return Id;case 35674:return Na;case 35675:return dc;case 35676:return ec;case 35678:return fc;case 35680:return db;case 5124:case 35670:return yb;case 35667:case 35671:return ob;case 35668:case 35672:return cb;
case 35669:case 35673:return pb}}function Oc(g,a,b){this.id=g;this.addr=b;this.cache=[];this.setValue=Hd(a.type)}function wa(g,a,b){this.id=g;this.addr=b;this.cache=[];this.size=a.size;this.setValue=Ib(a.type)}function xa(g){this.id=g;this.seq=[];this.map={}}function zb(g,a,b){this.seq=[];this.map={};this.renderer=b;b=g.getProgramParameter(a,g.ACTIVE_UNIFORMS);for(var q=0;q<b;++q){var d=g.getActiveUniform(a,q),c=g.getUniformLocation(a,d.name),D=this,k=d.name,f=k.length;for(pe.lastIndex=0;;){var e=
pe.exec(k),l=pe.lastIndex,p=e[1],h=e[3];']'===e[2]&&(p|=0);if(void 0===h||'['===h&&l+2===f){k=D;d=void 0===h?new Oc(p,d,c):new wa(p,d,c);k.seq.push(d);k.map[d.id]=d;break}else h=D.map[p],void 0===h&&(h=new xa(p),p=D,D=h,p.seq.push(D),p.map[D.id]=D),D=h}}}function za(g){g=g.split('\n');for(var a=0;a<g.length;a++)g[a]=a+1+': '+g[a];return g.join('\n')}function eb(g,a,b){var q=g.createShader(a);g.shaderSource(q,b);g.compileShader(q);!1===g.getShaderParameter(q,g.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile.");
''!==g.getShaderInfoLog(q)&&console.warn('THREE.WebGLShader: gl.getShaderInfoLog()',a===g.VERTEX_SHADER?'vertex':'fragment',g.getShaderInfoLog(q),za(b));return q}function rb(g){switch(g){case 3E3:return['Linear','( value )'];case 3001:return['sRGB','( value )'];case 3002:return['RGBE','( value )'];case 3004:return['RGBM','( value, 7.0 )'];case 3005:return['RGBM','( value, 16.0 )'];case 3006:return['RGBD','( value, 256.0 )'];case 3007:return['Gamma','( value, float( GAMMA_FACTOR ) )'];default:throw Error('unsupported encoding: '+
g);}}function Ua(g,a){a=rb(a);return'vec4 '+g+'( vec4 value ) { return '+a[0]+'ToLinear'+a[1]+'; }'}function Ab(g,a){a=rb(a);return'vec4 '+g+'( vec4 value ) { return LinearTo'+a[0]+a[1]+'; }'}function la(g,a){switch(a){case 1:a='Linear';break;case 2:a='Reinhard';break;case 3:a='Uncharted2';break;case 4:a='OptimizedCineon';break;default:throw Error('unsupported toneMapping: '+a);}return'vec3 '+g+'( vec3 color ) { return '+a+'ToneMapping( color ); }'}function Jd(g,a,b){g=g||{};return[g.derivatives||
a.envMapCubeUV||a.bumpMap||a.normalMap&&!a.objectSpaceNormalMap||a.flatShading?'#extension GL_OES_standard_derivatives : enable':'',(g.fragDepth||a.logarithmicDepthBuffer)&&b.get('EXT_frag_depth')?'#extension GL_EXT_frag_depth : enable':'',g.drawBuffers&&b.get('WEBGL_draw_buffers')?'#extension GL_EXT_draw_buffers : require':'',(g.shaderTextureLOD||a.envMap)&&b.get('EXT_shader_texture_lod')?'#extension GL_EXT_shader_texture_lod : enable':''].filter(Bb).join('\n')}function Kd(g){var a=[],b;for(b in g){var d=
g[b];!1!==d&&a.push('#define '+b+' '+d)}return a.join('\n')}function Bb(g){return''!==g}function ef(g,a){return g.replace(/NUM_DIR_LIGHTS/g,a.numDirLights).replace(/NUM_SPOT_LIGHTS/g,a.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,a.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,a.numPointLights).replace(/NUM_HEMI_LIGHTS/g,a.numHemiLights)}function Jb(g,a){return g.replace(/NUM_CLIPPING_PLANES/g,a.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,a.numClippingPlanes-a.numClipIntersection)}function qe(g){return g.replace(/^[ \t]*#include +<([\w\d./]+)>/gm,
function(g,a){g=ma[a];if(void 0===g)throw Error('Can not resolve #include <'+a+'>');return qe(g)})}function ff(g){return g.replace(/#pragma unroll_loop[\s]+?for \( int i = (\d+); i < (\d+); i \+\+ \) \{([\s\S]+?)(?=\})\}/g,function(g,a,b,d){g='';for(a=parseInt(a);a<parseInt(b);a++)g+=d.replace(/\[ i \]/g,'[ '+a+' ]');return g})}function Tf(g,a,b,d,c,k,f){var q=g.context,D=d.defines,e=c.vertexShader,l=c.fragmentShader,p='SHADOWMAP_TYPE_BASIC';1===k.shadowMapType?p='SHADOWMAP_TYPE_PCF':2===k.shadowMapType&&
(p='SHADOWMAP_TYPE_PCF_SOFT');var h='ENVMAP_TYPE_CUBE',S='ENVMAP_MODE_REFLECTION',n='ENVMAP_BLENDING_MULTIPLY';if(k.envMap){switch(d.envMap.mapping){case 301:case 302:h='ENVMAP_TYPE_CUBE';break;case 306:case 307:h='ENVMAP_TYPE_CUBE_UV';break;case 303:case 304:h='ENVMAP_TYPE_EQUIREC';break;case 305:h='ENVMAP_TYPE_SPHERE'}switch(d.envMap.mapping){case 302:case 304:S='ENVMAP_MODE_REFRACTION'}switch(d.combine){case 0:n='ENVMAP_BLENDING_MULTIPLY';break;case 1:n='ENVMAP_BLENDING_MIX';break;case 2:n='ENVMAP_BLENDING_ADD'}}var m=
0<g.gammaFactor?g.gammaFactor:1,t=f.isWebGL2?'':Jd(d.extensions,k,a),r=Kd(D),u=q.createProgram();d.isRawShaderMaterial?(D=[r].filter(Bb).join('\n'),0<D.length&&(D+='\n'),a=[t,r].filter(Bb).join('\n'),0<a.length&&(a+='\n')):(D=['precision '+k.precision+' float;','precision '+k.precision+' int;','#define SHADER_NAME '+c.name,r,k.supportsVertexTextures?'#define VERTEX_TEXTURES':'','#define GAMMA_FACTOR '+m,'#define MAX_BONES '+k.maxBones,k.useFog&&k.fog?'#define USE_FOG':'',k.useFog&&k.fogExp?'#define FOG_EXP2':
'',k.map?'#define USE_MAP':'',k.envMap?'#define USE_ENVMAP':'',k.envMap?'#define '+S:'',k.lightMap?'#define USE_LIGHTMAP':'',k.aoMap?'#define USE_AOMAP':'',k.emissiveMap?'#define USE_EMISSIVEMAP':'',k.bumpMap?'#define USE_BUMPMAP':'',k.normalMap?'#define USE_NORMALMAP':'',k.normalMap&&k.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',k.displacementMap&&k.supportsVertexTextures?'#define USE_DISPLACEMENTMAP':'',k.specularMap?'#define USE_SPECULARMAP':'',k.roughnessMap?'#define USE_ROUGHNESSMAP':
'',k.metalnessMap?'#define USE_METALNESSMAP':'',k.alphaMap?'#define USE_ALPHAMAP':'',k.vertexColors?'#define USE_COLOR':'',k.flatShading?'#define FLAT_SHADED':'',k.skinning?'#define USE_SKINNING':'',k.useVertexTexture?'#define BONE_TEXTURE':'',k.morphTargets?'#define USE_MORPHTARGETS':'',k.morphNormals&&!1===k.flatShading?'#define USE_MORPHNORMALS':'',k.doubleSided?'#define DOUBLE_SIDED':'',k.flipSided?'#define FLIP_SIDED':'',k.shadowMapEnabled?'#define USE_SHADOWMAP':'',k.shadowMapEnabled?'#define '+
p:'',k.sizeAttenuation?'#define USE_SIZEATTENUATION':'',k.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',k.logarithmicDepthBuffer&&(f.isWebGL2||a.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'','uniform mat4 modelMatrix;','uniform mat4 modelViewMatrix;','uniform mat4 projectionMatrix;','uniform mat4 viewMatrix;','uniform mat3 normalMatrix;','uniform vec3 cameraPosition;','attribute vec3 position;','attribute vec3 normal;','attribute vec2 uv;','#ifdef USE_COLOR','\tattribute vec3 color;',
'#endif','#ifdef USE_MORPHTARGETS','\tattribute vec3 morphTarget0;','\tattribute vec3 morphTarget1;','\tattribute vec3 morphTarget2;','\tattribute vec3 morphTarget3;','\t#ifdef USE_MORPHNORMALS','\t\tattribute vec3 morphNormal0;','\t\tattribute vec3 morphNormal1;','\t\tattribute vec3 morphNormal2;','\t\tattribute vec3 morphNormal3;','\t#else','\t\tattribute vec3 morphTarget4;','\t\tattribute vec3 morphTarget5;','\t\tattribute vec3 morphTarget6;','\t\tattribute vec3 morphTarget7;','\t#endif','#endif',
'#ifdef USE_SKINNING','\tattribute vec4 skinIndex;','\tattribute vec4 skinWeight;','#endif','\n'].filter(Bb).join('\n'),a=[t,'precision '+k.precision+' float;','precision '+k.precision+' int;','#define SHADER_NAME '+c.name,r,k.alphaTest?'#define ALPHATEST '+k.alphaTest+(k.alphaTest%1?'':'.0'):'','#define GAMMA_FACTOR '+m,k.useFog&&k.fog?'#define USE_FOG':'',k.useFog&&k.fogExp?'#define FOG_EXP2':'',k.map?'#define USE_MAP':'',k.envMap?'#define USE_ENVMAP':'',k.envMap?'#define '+h:'',k.envMap?'#define '+
S:'',k.envMap?'#define '+n:'',k.lightMap?'#define USE_LIGHTMAP':'',k.aoMap?'#define USE_AOMAP':'',k.emissiveMap?'#define USE_EMISSIVEMAP':'',k.bumpMap?'#define USE_BUMPMAP':'',k.normalMap?'#define USE_NORMALMAP':'',k.normalMap&&k.objectSpaceNormalMap?'#define OBJECTSPACE_NORMALMAP':'',k.specularMap?'#define USE_SPECULARMAP':'',k.roughnessMap?'#define USE_ROUGHNESSMAP':'',k.metalnessMap?'#define USE_METALNESSMAP':'',k.alphaMap?'#define USE_ALPHAMAP':'',k.vertexColors?'#define USE_COLOR':'',k.gradientMap?
'#define USE_GRADIENTMAP':'',k.flatShading?'#define FLAT_SHADED':'',k.doubleSided?'#define DOUBLE_SIDED':'',k.flipSided?'#define FLIP_SIDED':'',k.shadowMapEnabled?'#define USE_SHADOWMAP':'',k.shadowMapEnabled?'#define '+p:'',k.premultipliedAlpha?'#define PREMULTIPLIED_ALPHA':'',k.physicallyCorrectLights?'#define PHYSICALLY_CORRECT_LIGHTS':'',k.logarithmicDepthBuffer?'#define USE_LOGDEPTHBUF':'',k.logarithmicDepthBuffer&&(f.isWebGL2||a.get('EXT_frag_depth'))?'#define USE_LOGDEPTHBUF_EXT':'',k.envMap&&
(f.isWebGL2||a.get('EXT_shader_texture_lod'))?'#define TEXTURE_LOD_EXT':'','uniform mat4 viewMatrix;','uniform vec3 cameraPosition;',0!==k.toneMapping?'#define TONE_MAPPING':'',0!==k.toneMapping?ma.tonemapping_pars_fragment:'',0!==k.toneMapping?la('toneMapping',k.toneMapping):'',k.dithering?'#define DITHERING':'',k.outputEncoding||k.mapEncoding||k.envMapEncoding||k.emissiveMapEncoding?ma.encodings_pars_fragment:'',k.mapEncoding?Ua('mapTexelToLinear',k.mapEncoding):'',k.envMapEncoding?Ua('envMapTexelToLinear',
k.envMapEncoding):'',k.emissiveMapEncoding?Ua('emissiveMapTexelToLinear',k.emissiveMapEncoding):'',k.outputEncoding?Ab('linearToOutputTexel',k.outputEncoding):'',k.depthPacking?'#define DEPTH_PACKING '+d.depthPacking:'','\n'].filter(Bb).join('\n'));e=qe(e);e=ef(e,k);e=Jb(e,k);l=qe(l);l=ef(l,k);l=Jb(l,k);e=ff(e);l=ff(l);f.isWebGL2&&!d.isRawShaderMaterial&&(f=!1,p=/^\s*#version\s+300\s+es\s*\n/,d.isShaderMaterial&&null!==e.match(p)&&null!==l.match(p)&&(f=!0,e=e.replace(p,''),l=l.replace(p,'')),D='#version 300 es\n\n#define attribute in\n#define varying out\n#define texture2D texture\n'+
D,a=['#version 300 es\n\n#define varying in',f?'':'out highp vec4 pc_fragColor;',f?'':'#define gl_FragColor pc_fragColor','#define gl_FragDepthEXT gl_FragDepth\n#define texture2D texture\n#define textureCube texture\n#define texture2DProj textureProj\n#define texture2DLodEXT textureLod\n#define texture2DProjLodEXT textureProjLod\n#define textureCubeLodEXT textureLod\n#define texture2DGradEXT textureGrad\n#define texture2DProjGradEXT textureProjGrad\n#define textureCubeGradEXT textureGrad'].join('\n')+
'\n'+a);l=a+l;e=eb(q,q.VERTEX_SHADER,D+e);l=eb(q,q.FRAGMENT_SHADER,l);q.attachShader(u,e);q.attachShader(u,l);void 0!==d.index0AttributeName?q.bindAttribLocation(u,0,d.index0AttributeName):!0===k.morphTargets&&q.bindAttribLocation(u,0,'position');q.linkProgram(u);k=q.getProgramInfoLog(u).trim();f=q.getShaderInfoLog(e).trim();p=q.getShaderInfoLog(l).trim();S=h=!0;if(!1===q.getProgramParameter(u,q.LINK_STATUS))h=!1,console.error('THREE.WebGLProgram: shader error: ',q.getError(),'gl.VALIDATE_STATUS',
q.getProgramParameter(u,q.VALIDATE_STATUS),'gl.getProgramInfoLog',k,f,p);else if(''!==k)console.warn('THREE.WebGLProgram: gl.getProgramInfoLog()',k);else if(''===f||''===p)S=!1;S&&(this.diagnostics={runnable:h,material:d,programLog:k,vertexShader:{log:f,prefix:D},fragmentShader:{log:p,prefix:a}});q.deleteShader(e);q.deleteShader(l);var v;this.getUniforms=function(){void 0===v&&(v=new zb(q,u,g));return v};var T;this.getAttributes=function(){if(void 0===T){for(var g={},a=q.getProgramParameter(u,q.ACTIVE_ATTRIBUTES),
b=0;b<a;b++){var d=q.getActiveAttrib(u,b).name;g[d]=q.getAttribLocation(u,d)}T=g}return T};this.destroy=function(){q.deleteProgram(u);this.program=void 0};Object.defineProperties(this,{uniforms:{get:function(){console.warn('THREE.WebGLProgram: .uniforms is now .getUniforms().');return this.getUniforms()}},attributes:{get:function(){console.warn('THREE.WebGLProgram: .attributes is now .getAttributes().');return this.getAttributes()}}});this.name=c.name;this.id=Uf++;this.code=b;this.usedTimes=1;this.program=
u;this.vertexShader=e;this.fragmentShader=l;return this}function Vf(g,a,b){function q(g,a){if(g)g.isTexture?q=g.encoding:g.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),q=g.texture.encoding);else var q=3E3;3E3===q&&a&&(q=3007);return q}var d=[],c={MeshDepthMaterial:'depth',MeshDistanceMaterial:'distanceRGBA',MeshNormalMaterial:'normal',MeshBasicMaterial:'basic',MeshLambertMaterial:'lambert',
MeshPhongMaterial:'phong',MeshToonMaterial:'phong',MeshStandardMaterial:'physical',MeshPhysicalMaterial:'physical',LineBasicMaterial:'basic',LineDashedMaterial:'dashed',PointsMaterial:'points',ShadowMaterial:'shadow',SpriteMaterial:'sprite'},k='precision supportsVertexTextures map mapEncoding envMap envMapMode envMapEncoding lightMap aoMap emissiveMap emissiveMapEncoding bumpMap normalMap objectSpaceNormalMap displacementMap specularMap roughnessMap metalnessMap gradientMap alphaMap combine vertexColors fog useFog fogExp flatShading sizeAttenuation logarithmicDepthBuffer skinning maxBones useVertexTexture morphTargets morphNormals maxMorphTargets maxMorphNormals premultipliedAlpha numDirLights numPointLights numSpotLights numHemiLights numRectAreaLights shadowMapEnabled shadowMapType toneMapping physicallyCorrectLights alphaTest doubleSided flipSided numClippingPlanes numClipIntersection depthPacking dithering'.split(' ');
this.getParameters=function(a,d,k,D,f,e,l){var p=c[a.type];if(l.isSkinnedMesh){var h=l.skeleton.bones;if(b.floatVertexTextures)h=1024;else{var S=Math.min(Math.floor((b.maxVertexUniforms-20)/4),h.length);S<h.length?(console.warn('THREE.WebGLRenderer: Skeleton has '+h.length+' bones. This GPU supports '+S+'.'),h=0):h=S}}else h=0;S=b.precision;null!==a.precision&&(S=b.getMaxPrecision(a.precision),S!==a.precision&&console.warn('THREE.WebGLProgram.getParameters:',a.precision,'not supported, using',S,'instead.'));
var n=g.getRenderTarget();return{shaderID:p,precision:S,supportsVertexTextures:b.vertexTextures,outputEncoding:q(n?n.texture:null,g.gammaOutput),map:!!a.map,mapEncoding:q(a.map,g.gammaInput),envMap:!!a.envMap,envMapMode:a.envMap&&a.envMap.mapping,envMapEncoding:q(a.envMap,g.gammaInput),envMapCubeUV:!!a.envMap&&(306===a.envMap.mapping||307===a.envMap.mapping),lightMap:!!a.lightMap,aoMap:!!a.aoMap,emissiveMap:!!a.emissiveMap,emissiveMapEncoding:q(a.emissiveMap,g.gammaInput),bumpMap:!!a.bumpMap,normalMap:!!a.normalMap,
objectSpaceNormalMap:1===a.normalMapType,displacementMap:!!a.displacementMap,roughnessMap:!!a.roughnessMap,metalnessMap:!!a.metalnessMap,specularMap:!!a.specularMap,alphaMap:!!a.alphaMap,gradientMap:!!a.gradientMap,combine:a.combine,vertexColors:a.vertexColors,fog:!!D,useFog:a.fog,fogExp:D&&D.isFogExp2,flatShading:a.flatShading,sizeAttenuation:a.sizeAttenuation,logarithmicDepthBuffer:b.logarithmicDepthBuffer,skinning:a.skinning&&0<h,maxBones:h,useVertexTexture:b.floatVertexTextures,morphTargets:a.morphTargets,
morphNormals:a.morphNormals,maxMorphTargets:g.maxMorphTargets,maxMorphNormals:g.maxMorphNormals,numDirLights:d.directional.length,numPointLights:d.point.length,numSpotLights:d.spot.length,numRectAreaLights:d.rectArea.length,numHemiLights:d.hemi.length,numClippingPlanes:f,numClipIntersection:e,dithering:a.dithering,shadowMapEnabled:g.shadowMap.enabled&&l.receiveShadow&&0<k.length,shadowMapType:g.shadowMap.type,toneMapping:g.toneMapping,physicallyCorrectLights:g.physicallyCorrectLights,premultipliedAlpha:a.premultipliedAlpha,
alphaTest:a.alphaTest,doubleSided:2===a.side,flipSided:1===a.side,depthPacking:void 0!==a.depthPacking?a.depthPacking:!1}};this.getProgramCode=function(a,q){var b=[];q.shaderID?b.push(q.shaderID):(b.push(a.fragmentShader),b.push(a.vertexShader));if(void 0!==a.defines)for(var d in a.defines)b.push(d),b.push(a.defines[d]);for(d=0;d<k.length;d++)b.push(q[k[d]]);b.push(a.onBeforeCompile.toString());b.push(g.gammaOutput);return b.join()};this.acquireProgram=function(q,c,k,D){for(var f,e=0,l=d.length;e<
l;e++){var p=d[e];if(p.code===D){f=p;++f.usedTimes;break}}void 0===f&&(f=new Tf(g,a,D,q,c,k,b),d.push(f));return f};this.releaseProgram=function(g){if(0===--g.usedTimes){var a=d.indexOf(g);d[a]=d[d.length-1];d.pop();g.destroy()}};this.programs=d}function Wf(){var g=new WeakMap;return{get:function(a){var q=g.get(a);void 0===q&&(q={},g.set(a,q));return q},remove:function(a){g.delete(a)},update:function(a,b,d){g.get(a)[b]=d},dispose:function(){g=new WeakMap}}}function Xf(g,a){return g.renderOrder!==
a.renderOrder?g.renderOrder-a.renderOrder:g.program&&a.program&&g.program!==a.program?g.program.id-a.program.id:g.material.id!==a.material.id?g.material.id-a.material.id:g.z!==a.z?g.z-a.z:g.id-a.id}function Yf(g,a){return g.renderOrder!==a.renderOrder?g.renderOrder-a.renderOrder:g.z!==a.z?a.z-g.z:g.id-a.id}function Zf(){var g=[],a=0,b=[],d=[];return{opaque:b,transparent:d,init:function(){a=0;b.length=0;d.length=0},push:function(q,c,k,D,f){var e=g[a];void 0===e?(e={id:q.id,object:q,geometry:c,material:k,
program:k.program,renderOrder:q.renderOrder,z:D,group:f},g[a]=e):(e.id=q.id,e.object=q,e.geometry=c,e.material=k,e.program=k.program,e.renderOrder=q.renderOrder,e.z=D,e.group=f);(!0===k.transparent?d:b).push(e);a++},sort:function(){1<b.length&&b.sort(Xf);1<d.length&&d.sort(Yf)}}}function $f(){var g={};return{get:function(a,b){a=a.id+','+b.id;b=g[a];void 0===b&&(b=new Zf,g[a]=b);return b},dispose:function(){g={}}}}function ag(){var g={};return{get:function(a){if(void 0!==g[a.id])return g[a.id];switch(a.type){case 'DirectionalLight':var q=
{direction:new f,color:new y,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new h};break;case 'SpotLight':q={position:new f,direction:new f,color:new y,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new h};break;case 'PointLight':q={position:new f,color:new y,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new h,shadowCameraNear:1,shadowCameraFar:1E3};break;case 'HemisphereLight':q={direction:new f,skyColor:new y,groundColor:new y};
break;case 'RectAreaLight':q={color:new y,position:new f,halfWidth:new f,halfHeight:new f}}return g[a.id]=q}}}function bg(){var g=new ag,a={id:cg++,hash:{stateID:-1,directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,shadowsLength:-1},ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},d=new f,c=new b,k=new b;return{setup:function(q,
b,D){var f=0,e=0,l=0,p=0,h=0,S=0,n=0,m=0;D=D.matrixWorldInverse;for(var t=0,r=q.length;t<r;t++){var u=q[t],v=u.color,T=u.intensity,w=u.distance,ka=u.shadow&&u.shadow.map?u.shadow.map.texture:null;if(u.isAmbientLight)f+=v.r*T,e+=v.g*T,l+=v.b*T;else if(u.isDirectionalLight){var x=g.get(u);x.color.copy(u.color).multiplyScalar(u.intensity);x.direction.setFromMatrixPosition(u.matrixWorld);d.setFromMatrixPosition(u.target.matrixWorld);x.direction.sub(d);x.direction.transformDirection(D);if(x.shadow=u.castShadow)v=
u.shadow,x.shadowBias=v.bias,x.shadowRadius=v.radius,x.shadowMapSize=v.mapSize;a.directionalShadowMap[p]=ka;a.directionalShadowMatrix[p]=u.shadow.matrix;a.directional[p]=x;p++}else if(u.isSpotLight){x=g.get(u);x.position.setFromMatrixPosition(u.matrixWorld);x.position.applyMatrix4(D);x.color.copy(v).multiplyScalar(T);x.distance=w;x.direction.setFromMatrixPosition(u.matrixWorld);d.setFromMatrixPosition(u.target.matrixWorld);x.direction.sub(d);x.direction.transformDirection(D);x.coneCos=Math.cos(u.angle);
x.penumbraCos=Math.cos(u.angle*(1-u.penumbra));x.decay=0===u.distance?0:u.decay;if(x.shadow=u.castShadow)v=u.shadow,x.shadowBias=v.bias,x.shadowRadius=v.radius,x.shadowMapSize=v.mapSize;a.spotShadowMap[S]=ka;a.spotShadowMatrix[S]=u.shadow.matrix;a.spot[S]=x;S++}else if(u.isRectAreaLight)x=g.get(u),x.color.copy(v).multiplyScalar(T),x.position.setFromMatrixPosition(u.matrixWorld),x.position.applyMatrix4(D),k.identity(),c.copy(u.matrixWorld),c.premultiply(D),k.extractRotation(c),x.halfWidth.set(.5*u.width,
0,0),x.halfHeight.set(0,.5*u.height,0),x.halfWidth.applyMatrix4(k),x.halfHeight.applyMatrix4(k),a.rectArea[n]=x,n++;else if(u.isPointLight){x=g.get(u);x.position.setFromMatrixPosition(u.matrixWorld);x.position.applyMatrix4(D);x.color.copy(u.color).multiplyScalar(u.intensity);x.distance=u.distance;x.decay=0===u.distance?0:u.decay;if(x.shadow=u.castShadow)v=u.shadow,x.shadowBias=v.bias,x.shadowRadius=v.radius,x.shadowMapSize=v.mapSize,x.shadowCameraNear=v.camera.near,x.shadowCameraFar=v.camera.far;
a.pointShadowMap[h]=ka;a.pointShadowMatrix[h]=u.shadow.matrix;a.point[h]=x;h++}else u.isHemisphereLight&&(x=g.get(u),x.direction.setFromMatrixPosition(u.matrixWorld),x.direction.transformDirection(D),x.direction.normalize(),x.skyColor.copy(u.color).multiplyScalar(T),x.groundColor.copy(u.groundColor).multiplyScalar(T),a.hemi[m]=x,m++)}a.ambient[0]=f;a.ambient[1]=e;a.ambient[2]=l;a.directional.length=p;a.spot.length=S;a.rectArea.length=n;a.point.length=h;a.hemi.length=m;a.hash.stateID=a.id;a.hash.directionalLength=
p;a.hash.pointLength=h;a.hash.spotLength=S;a.hash.rectAreaLength=n;a.hash.hemiLength=m;a.hash.shadowsLength=b.length},state:a}}function gf(){var g=new bg,a=[],b=[];return{init:function(){a.length=0;b.length=0},state:{lightsArray:a,shadowsArray:b,lights:g},setupLights:function(q){g.setup(a,b,q)},pushLight:function(g){a.push(g)},pushShadow:function(g){b.push(g)}}}function dg(){var g={};return{get:function(a,b){if(void 0===g[a.id]){var q=new gf;g[a.id]={};g[a.id][b.id]=q}else void 0===g[a.id][b.id]?
(q=new gf,g[a.id][b.id]=q):q=g[a.id][b.id];return q},dispose:function(){g={}}}}function Cb(g){W.call(this);this.type='MeshDepthMaterial';this.depthPacking=3200;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.wireframe=!1;this.wireframeLinewidth=1;this.lights=this.fog=!1;this.setValues(g)}function Db(g){W.call(this);this.type='MeshDistanceMaterial';this.referencePosition=new f;this.nearDistance=1;this.farDistance=
1E3;this.morphTargets=this.skinning=!1;this.displacementMap=this.alphaMap=this.map=null;this.displacementScale=1;this.displacementBias=0;this.lights=this.fog=!1;this.setValues(g)}function hf(g,a,d){function q(a,q,b,d,c,k){var D=a.geometry,f=m,e=a.customDepthMaterial;b&&(f=t,e=a.customDistanceMaterial);e?f=e:(e=!1,q.morphTargets&&(D&&D.isBufferGeometry?e=D.morphAttributes&&D.morphAttributes.position&&0<D.morphAttributes.position.length:D&&D.isGeometry&&(e=D.morphTargets&&0<D.morphTargets.length)),
a.isSkinnedMesh&&!1===q.skinning&&console.warn('THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:',a),a=a.isSkinnedMesh&&q.skinning,D=0,e&&(D|=1),a&&(D|=2),f=f[D]);g.localClippingEnabled&&!0===q.clipShadows&&0!==q.clippingPlanes.length&&(D=f.uuid,e=q.uuid,a=v[D],void 0===a&&(a={},v[D]=a),D=a[e],void 0===D&&(D=f.clone(),a[e]=D),f=D);f.visible=q.visible;f.wireframe=q.wireframe;f.side=null!=q.shadowSide?q.shadowSide:w[q.side];f.clipShadows=q.clipShadows;f.clippingPlanes=q.clippingPlanes;
f.clipIntersection=q.clipIntersection;f.wireframeLinewidth=q.wireframeLinewidth;f.linewidth=q.linewidth;b&&f.isMeshDistanceMaterial&&(f.referencePosition.copy(d),f.nearDistance=c,f.farDistance=k);return f}function c(b,d,D,f){if(!1!==b.visible){if(b.layers.test(d.layers)&&(b.isMesh||b.isLine||b.isPoints)&&b.castShadow&&(!b.frustumCulled||k.intersectsObject(b))){b.modelViewMatrix.multiplyMatrices(D.matrixWorldInverse,b.matrixWorld);var e=a.update(b),l=b.material;if(Array.isArray(l))for(var p=e.groups,
h=0,S=p.length;h<S;h++){var n=p[h],m=l[n.materialIndex];m&&m.visible&&(m=q(b,m,f,u,D.near,D.far),g.renderBufferDirect(D,null,e,m,b,n))}else l.visible&&(m=q(b,l,f,u,D.near,D.far),g.renderBufferDirect(D,null,e,m,b,null))}b=b.children;e=0;for(l=b.length;e<l;e++)c(b[e],d,D,f)}}var k=new z,D=new b,e=new h,l=new h(d,d),p=new f,u=new f,m=Array(4),t=Array(4),v={},w={0:1,1:0,2:2},x=[new f(1,0,0),new f(-1,0,0),new f(0,0,1),new f(0,0,-1),new f(0,1,0),new f(0,-1,0)],y=[new f(0,1,0),new f(0,1,0),new f(0,1,0),
new f(0,1,0),new f(0,0,1),new f(0,0,-1)],E=[new n,new n,new n,new n,new n,new n];for(d=0;4!==d;++d){var B=0!==(d&1),C=0!==(d&2),A=new Cb({depthPacking:3201,morphTargets:B,skinning:C});m[d]=A;B=new Db({morphTargets:B,skinning:C});t[d]=B}var F=this;this.enabled=!1;this.autoUpdate=!0;this.needsUpdate=!1;this.type=1;this.render=function(a,q,b){if(!1!==F.enabled&&(!1!==F.autoUpdate||!1!==F.needsUpdate)&&0!==a.length){var d=g.state;d.disable(g.context.BLEND);d.buffers.color.setClear(1,1,1,1);d.buffers.depth.setTest(!0);
d.setScissorTest(!1);for(var f,h=0,S=a.length;h<S;h++){var n=a[h];f=n.shadow;var m=n&&n.isPointLight;if(void 0===f)console.warn('THREE.WebGLShadowMap:',n,'has no shadow.');else{var t=f.camera;e.copy(f.mapSize);e.min(l);if(m){var v=e.x,T=e.y;E[0].set(2*v,T,v,T);E[1].set(0,T,v,T);E[2].set(3*v,T,v,T);E[3].set(v,T,v,T);E[4].set(3*v,0,v,T);E[5].set(v,0,v,T);e.x*=4;e.y*=2}null===f.map&&(f.map=new r(e.x,e.y,{minFilter:1003,magFilter:1003,format:1023}),f.map.texture.name=n.name+'.shadowMap',t.updateProjectionMatrix());
f.isSpotLightShadow&&f.update(n);v=f.map;T=f.matrix;u.setFromMatrixPosition(n.matrixWorld);t.position.copy(u);m?(f=6,T.makeTranslation(-u.x,-u.y,-u.z)):(f=1,p.setFromMatrixPosition(n.target.matrixWorld),t.lookAt(p),t.updateMatrixWorld(),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(t.projectionMatrix),T.multiply(t.matrixWorldInverse));g.setRenderTarget(v);g.clear();for(n=0;n<f;n++)m&&(p.copy(t.position),p.add(x[n]),t.up.copy(y[n]),t.lookAt(p),t.updateMatrixWorld(),d.viewport(E[n])),D.multiplyMatrices(t.projectionMatrix,
t.matrixWorldInverse),k.setFromMatrix(D),c(q,b,t,m)}}F.needsUpdate=!1}}}function eg(g,a,b,d){function q(a,q,b){var d=new Uint8Array(4),c=g.createTexture();g.bindTexture(a,c);g.texParameteri(a,g.TEXTURE_MIN_FILTER,g.NEAREST);g.texParameteri(a,g.TEXTURE_MAG_FILTER,g.NEAREST);for(a=0;a<b;a++)g.texImage2D(q+a,0,g.RGBA,1,1,0,g.RGBA,g.UNSIGNED_BYTE,d);return c}function c(q,b){r[q]=1;0===v[q]&&(g.enableVertexAttribArray(q),v[q]=1);w[q]!==b&&((d.isWebGL2?g:a.get('ANGLE_instanced_arrays'))[d.isWebGL2?'vertexAttribDivisor':
'vertexAttribDivisorANGLE'](q,b),w[q]=b)}function k(a){!0!==x[a]&&(g.enable(a),x[a]=!0)}function D(a){!1!==x[a]&&(g.disable(a),x[a]=!1)}function f(a,q,d,c,f,e,l,p){if(0===a)E&&(D(g.BLEND),E=!1);else if(E||(k(g.BLEND),E=!0),5!==a){if(a!==B||p!==M){if(100!==C||100!==H)g.blendEquation(g.FUNC_ADD),H=C=100;if(p)switch(a){case 1:g.blendFuncSeparate(g.ONE,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);break;case 2:g.blendFunc(g.ONE,g.ONE);break;case 3:g.blendFuncSeparate(g.ZERO,g.ZERO,g.ONE_MINUS_SRC_COLOR,
g.ONE_MINUS_SRC_ALPHA);break;case 4:g.blendFuncSeparate(g.ZERO,g.SRC_COLOR,g.ZERO,g.SRC_ALPHA);break;default:console.error('THREE.WebGLState: Invalid blending: ',a)}else switch(a){case 1:g.blendFuncSeparate(g.SRC_ALPHA,g.ONE_MINUS_SRC_ALPHA,g.ONE,g.ONE_MINUS_SRC_ALPHA);break;case 2:g.blendFunc(g.SRC_ALPHA,g.ONE);break;case 3:g.blendFunc(g.ZERO,g.ONE_MINUS_SRC_COLOR);break;case 4:g.blendFunc(g.ZERO,g.SRC_COLOR);break;default:console.error('THREE.WebGLState: Invalid blending: ',a)}J=I=F=A=null;B=a;
M=p}}else{f=f||q;e=e||d;l=l||c;if(q!==C||f!==H)g.blendEquationSeparate(b.convert(q),b.convert(f)),C=q,H=f;if(d!==A||c!==F||e!==I||l!==J)g.blendFuncSeparate(b.convert(d),b.convert(c),b.convert(e),b.convert(l)),A=d,F=c,I=e,J=l;B=a;M=null}}function e(a){V!==a&&(a?g.frontFace(g.CW):g.frontFace(g.CCW),V=a)}function l(a){0!==a?(k(g.CULL_FACE),a!==Q&&(1===a?g.cullFace(g.BACK):2===a?g.cullFace(g.FRONT):g.cullFace(g.FRONT_AND_BACK))):D(g.CULL_FACE);Q=a}function p(a,q,b){if(a){if(k(g.POLYGON_OFFSET_FILL),K!==
q||O!==b)g.polygonOffset(q,b),K=q,O=b}else D(g.POLYGON_OFFSET_FILL)}function h(a){void 0===a&&(a=g.TEXTURE0+N-1);Y!==a&&(g.activeTexture(a),Y=a)}var S=new function(){var a=!1,q=new n,b=null,d=new n(0,0,0,0);return{setMask:function(q){b===q||a||(g.colorMask(q,q,q,q),b=q)},setLocked:function(g){a=g},setClear:function(a,b,c,k,D){!0===D&&(a*=k,b*=k,c*=k);q.set(a,b,c,k);!1===d.equals(q)&&(g.clearColor(a,b,c,k),d.copy(q))},reset:function(){a=!1;b=null;d.set(-1,0,0,0)}}},m=new function(){var a=!1,q=null,
b=null,d=null;return{setTest:function(a){a?k(g.DEPTH_TEST):D(g.DEPTH_TEST)},setMask:function(b){q===b||a||(g.depthMask(b),q=b)},setFunc:function(a){if(b!==a){if(a)switch(a){case 0:g.depthFunc(g.NEVER);break;case 1:g.depthFunc(g.ALWAYS);break;case 2:g.depthFunc(g.LESS);break;case 3:g.depthFunc(g.LEQUAL);break;case 4:g.depthFunc(g.EQUAL);break;case 5:g.depthFunc(g.GEQUAL);break;case 6:g.depthFunc(g.GREATER);break;case 7:g.depthFunc(g.NOTEQUAL);break;default:g.depthFunc(g.LEQUAL)}else g.depthFunc(g.LEQUAL);
b=a}},setLocked:function(g){a=g},setClear:function(a){d!==a&&(g.clearDepth(a),d=a)},reset:function(){a=!1;d=b=q=null}}},t=new function(){var a=!1,q=null,b=null,d=null,c=null,f=null,e=null,l=null,p=null;return{setTest:function(a){a?k(g.STENCIL_TEST):D(g.STENCIL_TEST)},setMask:function(b){q===b||a||(g.stencilMask(b),q=b)},setFunc:function(a,q,k){if(b!==a||d!==q||c!==k)g.stencilFunc(a,q,k),b=a,d=q,c=k},setOp:function(a,q,b){if(f!==a||e!==q||l!==b)g.stencilOp(a,q,b),f=a,e=q,l=b},setLocked:function(g){a=
g},setClear:function(a){p!==a&&(g.clearStencil(a),p=a)},reset:function(){a=!1;p=l=e=f=c=d=b=q=null}}},u=g.getParameter(g.MAX_VERTEX_ATTRIBS),r=new Uint8Array(u),v=new Uint8Array(u),w=new Uint8Array(u),x={},z=null,y=null,E=null,B=null,C=null,A=null,F=null,H=null,I=null,J=null,M=!1,V=null,Q=null,G=null,K=null,O=null,N=g.getParameter(g.MAX_COMBINED_TEXTURE_IMAGE_UNITS),ea=!1;u=0;u=g.getParameter(g.VERSION);-1!==u.indexOf('WebGL')?(u=parseFloat(/^WebGL ([0-9])/.exec(u)[1]),ea=1<=u):-1!==u.indexOf('OpenGL ES')&&
(u=parseFloat(/^OpenGL ES ([0-9])/.exec(u)[1]),ea=2<=u);var Y=null,L={},X=new n,U=new n,R={};R[g.TEXTURE_2D]=q(g.TEXTURE_2D,g.TEXTURE_2D,1);R[g.TEXTURE_CUBE_MAP]=q(g.TEXTURE_CUBE_MAP,g.TEXTURE_CUBE_MAP_POSITIVE_X,6);S.setClear(0,0,0,1);m.setClear(1);t.setClear(0);k(g.DEPTH_TEST);m.setFunc(3);e(!1);l(1);k(g.CULL_FACE);f(0);return{buffers:{color:S,depth:m,stencil:t},initAttributes:function(){for(var g=0,a=r.length;g<a;g++)r[g]=0},enableAttribute:function(g){c(g,0)},enableAttributeAndDivisor:c,disableUnusedAttributes:function(){for(var a=
0,q=v.length;a!==q;++a)v[a]!==r[a]&&(g.disableVertexAttribArray(a),v[a]=0)},enable:k,disable:D,getCompressedTextureFormats:function(){if(null===z&&(z=[],a.get('WEBGL_compressed_texture_pvrtc')||a.get('WEBGL_compressed_texture_s3tc')||a.get('WEBGL_compressed_texture_etc1')||a.get('WEBGL_compressed_texture_astc')))for(var q=g.getParameter(g.COMPRESSED_TEXTURE_FORMATS),b=0;b<q.length;b++)z.push(q[b]);retur